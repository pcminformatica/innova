{% extends 'layout_main-drawer--dismissible_footer_topbar.html' %}
{% block page_description %}Innova, Innova Mujer, conexión innova, Servicios, Buscar, Profesional, Mercado, Talento{% endblock %}
{% block page_title %}Marketplace - Innova{% endblock %}
{% block body %}
<style>
    .mdc-card__media--square::before {
  margin-top: 0px !important;
}

.video {
  width: 100%;
  height: 400px;
  border: 1px solid red;
  overflow: hidden;
  position: relative;
}
#output1 {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}
</style>
<main class="s-main-content">
    <div class="container-color-background container-size-m">


        <div class="mdc-layout-grid">


       
            <div class="mdc-layout-grid__inner">
                <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12">
                    <div class="container-dashboard--card-info">
                        <div class="mdc-card mdc-card--color-on-primary">
                            <div class="mdc-card__content">
                                <p>
                                    <b>Nombre de la empresa:</b>
                                    {{ company.name }}
                                </p>
                                <p>
                                    <b>DNI Empresaria:</b>
                                    {{ company.dni }}
                                </p>
                                <p>
                                    <b>RTN :</b>
                                    {{ company.rtn }}
                                </p>
                                <p>
                                    <b>Direccion:</b>
                                    {{ company.address }}
                                </p>
                            </div>
    
                        </div>
                    </div>
                </div>

              <div class="mdc-layout-grid__cell--span-12-desktop mdc-layout-grid__cell--span-12-phone">
                <div class="mdc-card  mdc-card--color-on-primary">
                    <div class="mdc-card__primary-action" >
                      <div class="mdc-card__media mdc-card__media--square">
                        <div class="mdc-layout-grid">
                            <div class="mdc-layout-grid">
                                <div class="mdc-layout-grid__inner">
                                 
                                  <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12-desktop mdc-layout-grid__cell--span-4-tablet 
                                  mdc-layout-grid__cell--span-12-phone mdc-layout-grid__cell--align-middle">

                                    
                                  <h2>
                                    Formulario 
                                </h2>
    
                                    <form id="formPIC"  action = "" method="POST" enctype = "multipart/form-data" onsubmit="return validarFormulario()">
                                        <label class="mdc-text-field mdc-text-field--filled" id="txt_name" data-assigned-var>
                                            <span class="mdc-text-field__ripple"></span>
                                            <span class="mdc-floating-label" id="my-label-id">Fecha</span>
                                            <input required class="mdc-text-field__input" type="date"  name="txt_date" aria-labelledby="my-label-id" 
                                        
                                            >
                                            <span lass="mdc-line-ripple"></span>
                                        </label>
                                        <br><br>
                                        <label class="mdc-text-field mdc-text-field--filled" id="txt_name" data-assigned-var>
                                            <span class="mdc-text-field__ripple"></span>
                                            <span class="mdc-floating-label" id="my-label-id">Hora</span>
                                            <input required class="mdc-text-field__input" type="time" name="txt_hours"  aria-labelledby="my-label-id" 
                                        
                                            >
                                            <span lass="mdc-line-ripple"></span>
                                        </label>
                                        <br>
                                        <br>
                                        <input type="hidden" name="selected_channel" id="selected_channel" value="">
                                        <input type="hidden" id="txt_company_id" name="txt_company_id"  value="{{company.id}}">
                    
                                        <input type="hidden"  name="txt_document_version" value="1">
                                        <div class="mdc-layout-grid__cell--span-4-desktop mdc-layout-grid__cell--span-12-phone">
                                            
                                            <label htmlFor="upload-photo" style="margin: auto">
                                                <input
                                                    style="display:none"
                                                    id="upload-photo"
                                                    name="upload-carta"
                                                    type="file"
                                                   
                                                />
                                                
                                                <Fab
                                                <button id="submitSaveButtonPIC" style="background-color: gray;"  class="mdc-button  mdc-button--raised mdc-button--leading">
                                                    <span class="mdc-button__ripple"></span>
                                                    <i class="material-icons mdc-button__icon" aria-hidden="true"
                                                        >add</i
                                                    >
                                                    <span class="mdc-button__label">Seleccione documento</span>
                                                    </button>
                                                </Fab>
                                                <br />
                                                <br />
                                                
                                                <Fab color="primary" size="small" component="span" aria-label="add">
                                                    <AddIcon />
                                                </Fab>
                                                </label>
                                            <br>
                                        <div class="mdc-typography--body1">
                                            Medio de atención por el cual contacto a la empresaria :
                                        </div>
                                        <div class="mdc-select mdc-select--filled demo-width-class"  id="txt_channel" data-assigned-var>
                                            <div class="mdc-select__anchor"
                                                role="button"
                                                aria-haspopup="listbox"
                                                aria-expanded="false"
                                                aria-labelledby="demo-label demo-selected-text">
                                                <span class="mdc-select__ripple"></span>
                                                <span id="demo-label" class="mdc-floating-label">Medio de atención </span>
                                                <span class="mdc-select__selected-text-container">
                                                <span id="demo-selected-text" class="mdc-select__selected-text"></span>
                                                </span>
                                                <span class="mdc-select__dropdown-icon">
                                                <svg
                                                    class="mdc-select__dropdown-icon-graphic"
                                                    viewBox="7 10 10 5" focusable="false">
                                                    <polygon
                                                        class="mdc-select__dropdown-icon-inactive"
                                                        stroke="none"
                                                        fill-rule="evenodd"
                                                        points="7 10 12 15 17 10">
                                                    </polygon>
                                                    <polygon
                                                        class="mdc-select__dropdown-icon-active"
                                                        stroke="none"
                                                        fill-rule="evenodd"
                                                        points="7 15 12 10 17 15">
                                                    </polygon>
                                                </svg>
                                                </span>
                                                <span class="mdc-line-ripple"></span>
                                            </div>
                                            
                                            <div class="mdc-select__menu mdc-menu mdc-menu-surface mdc-menu-surface--fullwidth">
                                                <ul class="mdc-deprecated-list" role="listbox" aria-label="Food picker listbox">
                                                        {% for channel in channel %}
                                                        <li class="mdc-deprecated-list-item mdc-deprecated-list-item--selected" aria-selected="false" data-value="{{ channel.name_short }}" role="option">
                                                            <span class="mdc-deprecated-list-item__ripple"></span>
                                                            <span class="mdc-deprecated-list-item__text">
                                                            {{ channel.name }}
                                                            </span>
                                                        </li>        
                                                        {% endfor %}
                                        
                                                </ul>
                                            </div>
                                            </div>
                                            <br> <br>
                                            <div class="mdc-typography--body1">
                                                Descripción actividad:
                                            </div>
                                            <label class="mdc-text-field mdc-text-field--outlined mdc-text-field--textarea mdc-text-field--with-internal-counter">
                                                <span class="mdc-notched-outline">
                                                <span class="mdc-notched-outline__leading"></span>
                                                <span class="mdc-notched-outline__notch">
                                                    <span class="mdc-floating-label" id="my-label-id">Descripción de la actividad</span>
                                                </span>
                                                <span class="mdc-notched-outline__trailing"></span>
                                                </span>
                                                <span class="mdc-text-field__resizer">
                                                <textarea id="txt_description" name="txt_description" class="mdc-text-field__input" aria-labelledby="my-label-id" rows="8" cols="40" maxlength="500"></textarea>
                                                <span class="mdc-text-field-character-counter">0 / 500</span>
                                                </span>
                                            </label>
                                        </div>
                              
                                        <br><br><br>
                                    
                                    
            

                                        <div class="s-font-align-center">
                                            <button type="submit" class="mdc-button mdc-button--raised mdc-button--leading mdc-button--color-secondary" >
                                                
                                                <span class="mdc-button__ripple"></span>
                                                <i class="material-icons mdc-button__icon" aria-hidden="true">check</i>
                                                <span class="mdc-button__label">Guardar seguimiento</span>
                                            </button>
                                        </div>
                                    </form>    
                                    
  
                        



            
                           

                      </div>
                                 
                                </div>
                              </div>
                        </div>
                      </div>
                      <!-- ... additional primary action content ... -->
                      <div class="mdc-card__ripple"></div>
                    </div>


                    <br>
                    <br>
                  </div>
              </div>

              <div class="mdc-layout-grid__cell--span-12-desktop mdc-layout-grid__cell--span-12-phone">
                <div class="mdc-card  mdc-card--color-on-primary">
                    <div class="mdc-card__primary-action" >
                      <div class="mdc-card__media mdc-card__media--square">
                        <div class="mdc-layout-grid">
                            <div class="mdc-layout-grid">
                                <div class="mdc-layout-grid__inner">
                                 
                                  <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12-desktop mdc-layout-grid__cell--span-4-tablet 
                                  mdc-layout-grid__cell--span-12-phone mdc-layout-grid__cell--align-middle">

                                    
                                  <h2>
                                    Historial de seguimientos 
                                </h2>
       
                                <div class="mdc-data-table__table-container">
                                    <table class="mdl-data-table_normal data_table_buttons" width="100%" cellspacing="0" style="white-space: normal;">
                                      <thead>
                                      <tr class="mdc-data-table__header-row">
                                        <th class="mdc-data-table__header-cell" role="columnheader" scope="col">#</th>
                                        <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Fecha </th>
                                        <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Medio de atención</th>
                                        <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Descripción</th>
                                        <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Documento</th>
                            
                                      </tr>
                                      </thead>
                                      
                                      <tbody class="mdc-data-table__content">
                                      {% for record in records %}
                                      <tr class="mdc-data-table__row">
                                      <th class="mdc-data-table__cell" scope="row">
                                      {{loop.index}}
                                      </th>
      
                                        <td class="mdc-data-table__cell" style="width: 80px;">
                                            {{ record.date }} - {{ record.hour }}
                                            
                                        </td>
                                        <th class="mdc-data-table__cell" scope="row">
                                            {{ record.service_channel.name }}
                                        </th>
                                        <th class="mdc-data-table__cell" scope="row">
                                           
                                            {{ record.description }}
                               
                                        </th>

                                        <th class="mdc-data-table__cell" scope="row">
                                           
                                          <a target="_blank" href="{{ url_for('static', filename='upload/') }}{{record.document_local}}">Ver</a>
                                        </th>
                                      </tr>
                                      {% endfor %}
                                      </tbody>
                                      <tfoot>
                                        <tr class="mdc-data-table__header-row">
                                            <th class="mdc-data-table__header-cell" role="columnheader" scope="col">#</th>
                                            <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Fecha </th>
                                            <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Medio de atención</th>
                                            <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Descripción</th>
                                            <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Documento</th>
                                        </tr>
                                    </tfoot>
                                      </table>
                                      </div>
  
                        



            
                           

                      </div>
                                 
                                </div>
                              </div>
                        </div>
                      </div>
                      <!-- ... additional primary action content ... -->
                      <div class="mdc-card__ripple"></div>
                    </div>


                    <br>
                    <br>
                  </div>
              </div>


           
            </div>
            
          </div>
     
        <div class="container-marketplace--drawer-app-content mdc-drawer-app-content mdc-top-app-bar--fixed-adjust">

            
        </div>
    </div>
</main>
{% endblock %}
{% block body_script_section %}
<script src="{{ url_for('static', filename='js/bundle/marketplace.min.js') }}"></script>
<script src="{{ url_for('static', filename='js/dc.js') }}"></script>
<script src="{{ url_for('static', filename='js/admin.js') }}?v=1.1"></script>

<script>
  function actualizarEtapa1(){

const Swal = swcms.returnSwal()


let postData = {
  "txt_documente_id":"{{ company.id }}"
};

console.log(postData)

let apiUrl = '/api/aprobar/documento/';


swcms.postFetch(apiUrl, postData).then((data) => {
  Swal.fire(
  'Éxito',
  'Documento aprobado',
  'success'
  )
  window.setTimeout(() => { window.location.reload(); }, 1500);

}).catch((error) => {
  Swal.fire(
  'Error de conexión',
  'Por favor revisar tu conexión a internet, si el problema persiste contacta al administrador del sistema',
  'error'
  )
  document.getElementById('btn_generar_carta').disabled = false;
});

}



  document.addEventListener('DOMContentLoaded', function () {
    var selectElement = document.getElementById('txt_channel');
    var hiddenInput = document.getElementById('selected_channel');

    // Agrega un evento de cambio al elemento select
    selectElement.addEventListener('change', function () {
      // Obtiene el valor seleccionado y lo asigna al input oculto
      var selectedValue = selectElement.querySelector('.mdc-select__selected-text').textContent;
      hiddenInput.value = selectedValue;
    });
  });

</script>
{% endblock %}