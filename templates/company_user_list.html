{% extends 'layout_main-drawer--dismissible_footer_topbar.html' %}
{% block page_description %}Innova Mujer Home, Casa, Dashboard, Home{% endblock %}
{% block page_title %}Innova Mujer Home{% endblock %}
{% block css_script_section %}
<style>
  .alignleft {
	  float: left;
  }
  .alignright {
    float: right;
  }
</style>
{% endblock %}
{% block body %}
<main class="s-main-content">
    <div class="container-color-background">
        <div class="mdc-layout-grid container-size-s">
            <div class="mdc-layout-grid__inner">
                <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-4-desktop mdc-layout-grid__cell--span-4-tablet 
                            mdc-layout-grid__cell--align-middle">
                    <div class="container-dashboard--profile">
                        <div class="mdc-card mdc-card--color-on-primary">
                            <div class="mdc-card__primary-action" tabindex="0">
                                <div class="mdc-card__media">

                                    <img class="profile-background" src="{{ url_for('static', filename='images/manifest/innova_perfil.svg') }} " alt="Border Perfil" />
                                    <img class="profile-pic-innova" src="{{ url_for('static', filename='images/manifest/innova_icon.svg') }}" alt="Foto Perfil" />
                                </div>
                                <div class="mdc-card__ripple"></div>
                            </div>
                            <div class="mdc-card__content">
                                <div class="mdc-typography--headline5 s-font-color-secondary">{{ company.name }}</div>
                                <div class="mdc-typography--subtitle1">RTN: {{ company.rtn }} </div>
                                <div class="mdc-typography--subtitle1">
                                    <i class="material-icons s-font-color-primary">verified_user</i>
                                    Empresa
                                </div>
                                <div class="mdc-typography--subtitle1">
                                    <i class="material-icons s-font-color-primary">business</i>
                                    ID: {{ company.dni }}
                                </div>
       


                            </div>
                            <div class="mdc-card__actions" style="justify-content:center;" >

                            </div>
                        </div>
                    </div>
                </div>
                <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-8-desktop mdc-layout-grid__cell--span-4-tablet">
                    <div class="container-dashboard--messages">
                        <div class="mdc-card mdc-card--color-on-primary">
                            <div class="mdc-tab-bar" role="tablist" data-action-fn="showMessagesContracts">
                                <div class="mdc-tab-scroller">
                                    <div class="mdc-tab-scroller__scroll-area">
                                        <div class="mdc-tab-scroller__scroll-content">
                                            <button class="mdc-tab mdc-tab--active" role="tab" aria-selected="true" tabindex="0">
                                                <span class="mdc-tab__content">
                                                    <span class="mdc-tab__text-label">USUARIOS</span>
                                                </span>
                                                <span class="mdc-tab-indicator mdc-tab-indicator--active">
                                                    <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>
                                                </span>
                                                <span class="mdc-tab__ripple"></span>
                                            </button>

                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mdc-card__content container-dashboard--messages-msg">
                                <div class="mdc-typography--headline5 s-font-color-secondary">Inscripcion</div>

                                {% if inscripciones %}
                                <div class="mdc-data-table" style="background-color: white;width: 100%;" >
                                    <div class="mdc-data-table__table-container">
                                      <table class="mdc-data-table__table_normal" aria-label="Dessert calories">
                                        <thead>
                                          <tr class="mdc-data-table__header-row">
                                            <th class="mdc-data-table__header-cell" role="columnheader" scope="col">#</th>
                                            <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Acciones</th>
                                            <th class="mdc-data-table__header-cell mdc-data-table__header-cell" role="columnheader" scope="col">Nombre</th>
                                            <th class="mdc-data-table__header-cell mdc-data-table__header-cell" role="columnheader" scope="col">Correo</th>
                                            <th class="mdc-data-table__header-cell mdc-data-table__header-cell" role="columnheader" scope="col">Teléfono</th>
                                            <th class="mdc-data-table__header-cell mdc-data-table__header-cell" role="columnheader" scope="col">Empresa</th>
                                            <th class="mdc-data-table__header-cell mdc-data-table__header-cell" role="columnheader" scope="col">Departamento</th>
                                            <th class="mdc-data-table__header-cell mdc-data-table__header-cell" role="columnheader" scope="col">Municipio</th>
                                          
                                    
                                            
                                            
                                            
                                            
                                            
                                            
                                          </tr>
                                          
                                          
                                          
                                        </thead>
                                        <tbody class="mdc-data-table__content">
                                            {% for inscripcione in inscripciones %}
                                          <tr class="mdc-data-table__row">
                                            <th class="mdc-data-table__cell" scope="row">{{loop.index}} </th>
                                            <td class="mdc-data-table__cell">
                                                <a href="#" onclick="saveUser('{{ inscripcione.correo}}','{{ inscripcione.name}}')" class="mdc-button mdc-button--raised mdc-button--leading" style="--mdc-ripple-fg-size: 75px; --mdc-ripple-fg-scale: 1.8784232240642684; --mdc-ripple-fg-translate-start: 16.41668701171875px, -7.866668701171875px; --mdc-ripple-fg-translate-end: 25.416671752929688px, -19.5px;">
                                                
                                                    <span class="mdc-button__ripple"></span>
                                                    <i class="material-icons mdc-button__icon" aria-hidden="true">edit</i>
                                                    <span class="mdc-button__label">Enviar usuario</span>
                                                </a>
                          
                                            </td>
                                            <th class="mdc-data-table__cell" scope="row">{{ inscripcione.name}}</th>
                                            <td class="mdc-data-table__cell mdc-data-table__cell--numeric">{{ inscripcione.correo}}</td>
                                            <td class="mdc-data-table__cell mdc-data-table__cell--numeric">{{ inscripcione.phone}}</td>
                                            <td class="mdc-data-table__cell mdc-data-table__cell--numeric">{{ inscripcione.company_name}}</td>
                                            <td class="mdc-data-table__cell mdc-data-table__cell--numeric">{{ inscripcione.departamento}}</td>
                                            <td class="mdc-data-table__cell mdc-data-table__cell--numeric">{{ inscripcione.municipio}}</td>
                                  
                   
                                            
                                          </tr>
                                          {% endfor %}
                                        </tbody>
                                      </table>
                                    </div>
                                  
                                    <div class="mdc-data-table__progress-indicator">
                                      <div class="mdc-data-table__scrim"></div>
                                      <div class="mdc-linear-progress mdc-linear-progress--indeterminate mdc-data-table__linear-progress" role="progressbar" aria-label="Data is being loaded...">
                                        <div class="mdc-linear-progress__buffer">
                                          <div class="mdc-linear-progress__buffer-bar"></div>
                                          <div class="mdc-linear-progress__buffer-dots"></div>
                                        </div>
                                        <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">
                                          <span class="mdc-linear-progress__bar-inner"></span>
                                        </div>
                                        <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">
                                          <span class="mdc-linear-progress__bar-inner"></span>
                                        </div>
                                      </div>
                                    </div>
                                </div>                                
                                {% else %}
                                 <p>No se encontraron inscripciones</p>
                                {% endif %}

                                <div class="mdc-typography--headline5 s-font-color-secondary">Usuarios</div>
                    
                                <div class="mdc-data-table" style="background-color: white;width: 100%;" >
                                    <div class="mdc-data-table__table-container">
                                      <table class="mdc-data-table__table" aria-label="Dessert calories">
                                        <thead>
                                          <tr class="mdc-data-table__header-row">
                                            <th class="mdc-data-table__header-cell" role="columnheader" scope="col">#</th>
                                            <th class="mdc-data-table__header-cell" role="columnheader" scope="col">Acciones</th>
                                            <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col">Username</th>
                                            <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col">Email</th>
                                            <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col">Estado</th>
                                    
                                            
                                          </tr>
                                          
                                          
                                          
                                        </thead>
                                        <tbody class="mdc-data-table__content">
                                            {% for user in users %}
                                          <tr class="mdc-data-table__row">
                                            <th class="mdc-data-table__cell" scope="row">{{loop.index}} </th>
                                            <td class="mdc-data-table__cell">
                                                <a href="#" onclick="alert('En construccion')" class="mdc-button mdc-button--raised mdc-button--leading" style="--mdc-ripple-fg-size: 75px; --mdc-ripple-fg-scale: 1.8784232240642684; --mdc-ripple-fg-translate-start: 16.41668701171875px, -7.866668701171875px; --mdc-ripple-fg-translate-end: 25.416671752929688px, -19.5px;">
                                                
                                                    <span class="mdc-button__ripple"></span>
                                                    <i class="material-icons mdc-button__icon" aria-hidden="true">edit</i>
                                                    <span class="mdc-button__label">Cambio de contraseña</span>
                                                </a>
                          
                                            </td>
                                            <th class="mdc-data-table__cell" scope="row">{{ user.name}}</th>
                                            <td class="mdc-data-table__cell mdc-data-table__cell--numeric">{{ user.email}}</td>
                                            <td class="mdc-data-table__cell mdc-data-table__cell--numeric">
                                              {% if user.enabled %}
                                                Activo
                                              {% else %}
                                                Inactivo
                                              {% endif %}
                                            </td>
 

                                            
                                          </tr>
                                          {% endfor %}
                                        </tbody>
                                      </table>
                                    </div>
                                  
                                    <div class="mdc-data-table__progress-indicator">
                                      <div class="mdc-data-table__scrim"></div>
                                      <div class="mdc-linear-progress mdc-linear-progress--indeterminate mdc-data-table__linear-progress" role="progressbar" aria-label="Data is being loaded...">
                                        <div class="mdc-linear-progress__buffer">
                                          <div class="mdc-linear-progress__buffer-bar"></div>
                                          <div class="mdc-linear-progress__buffer-dots"></div>
                                        </div>
                                        <div class="mdc-linear-progress__bar mdc-linear-progress__primary-bar">
                                          <span class="mdc-linear-progress__bar-inner"></span>
                                        </div>
                                        <div class="mdc-linear-progress__bar mdc-linear-progress__secondary-bar">
                                          <span class="mdc-linear-progress__bar-inner"></span>
                                        </div>
                                      </div>
                                    </div>
                                </div>
                            </div>
              
                                
                             


                            <div class="mdc-card__actions">
                                <div class="mdc-card__actions-buttons">
                                </div>
                                <div class="mdc-card__action-icons">
                                    <button class="mdc-icon-button material-icons mdc-card__action mdc-card__action--icon">
                                        <div class="mdc-icon-button__ripple"></div>
                                        more_vert
                                    </button>
                                </div>
                            </div>
                        
                        
                    </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</main>
{% endblock %}
{% block body_script_section %}
<script src="{{ url_for('static', filename='js/bundle/home-dashboard.min.js') }}"></script>
<script>
        function saveUser(email,name){

const Swal = swcms.returnSwal()


let postData = {
    "txt_email": email,
    "txt_name": name,
    "txt_company_id":"{{ company.id }}"
};

console.log(postData)

let apiUrl = '/create/company/user';
//document.getElementById('submitSaveButton').disabled = true;

swcms.postFetch(apiUrl, postData).then((data) => {
  if (data.status=='200'){
    Swal.fire(
    'Éxito',
    'Usuario creado creado!',
    'success'
    )
    window.setTimeout(() => { window.location.reload(); }, 1500);
  }else if (data.status=='201'){
    Swal.fire(
    'Correo ya existe',
    'Usuario no creado creado!',
    'error'
    )
  }else{
    Swal.fire(
    'Error de conexión',
    data.msg,
    'error'
    )
  }

}).catch((error) => {
    Swal.fire(
    'Error de conexión',
    'Por favor revisar tu conexión a internet, si el problema persiste contacta al administrador del sistema',
    'error'
    )
    //document.getElementById('submitSaveButton').disabled = false;
});

}
</script>
{% endblock %}