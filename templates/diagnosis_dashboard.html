{% extends 'layout_main-drawer--dismissible_footer_topbar.html' %}
{% block page_description %}Innova Mujer Home, Casa, Dashboard, Home{% endblock %}
{% block page_title %}Innova Mujer Home{% endblock %}
{% block css_script_section %}
<style>
    .alignleft {
	float: left;
    }
    .alignright {
        float: right;
    }
</style>
{% endblock %}
{% block body %}
<main class="s-main-content">
    <div class="container-color-background">
        <div class="mdc-layout-grid container-size-s">
            <div class="mdc-layout-grid__inner">
      <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-12-desktop mdc-layout-grid__cell--span-12-tablet mdc-layout-grid__cell--span-12-phone">
                <div class="container-dashboard--messages">
                    <div class="mdc-card mdc-card--color-on-primary">
                        <div class="mdc-tab-bar" role="tablist" data-action-fn="showMessagesContracts">
                            <div class="mdc-tab-scroller">
                                <div class="mdc-tab-scroller__scroll-area">
                                    <div class="mdc-tab-scroller__scroll-content">
                                        <button class="mdc-tab mdc-tab--active" role="tab" aria-selected="true" tabindex="0">
                                            <span class="mdc-tab__content">
                                                <span class="mdc-tab__text-label">Datos de la empresa</span>
                                            </span>
                                            <span class="mdc-tab-indicator mdc-tab-indicator--active">
                                                <span class="mdc-tab-indicator__content mdc-tab-indicator__content--underline"></span>
                                            </span>
                                            <span class="mdc-tab__ripple"></span>
                                        </button>

                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="mdc-card__content container-dashboard--messages-msg">
                            <div class="mdc-layout-grid__inner">
                                <div class="mdc-layout-grid__cell--span-6-desktop  mdc-layout-grid__cell--span-12-tablet mdc-layout-grid__cell--span-12-phone">
                                  <div class="mdc-typography--body1">
                                      Nombre de la empresa:
                                  </div>
                                  <label class="mdc-text-field mdc-text-field--filled" id="txt_name" data-assigned-var>
                                      <span class="mdc-text-field__ripple"></span>
                                     
                                      <input id="txt_company_name" value="{{ company.name }}" class="mdc-text-field__input" type="text" aria-labelledby="my-label-id" readonly>
                                      <span lass="mdc-line-ripple"></span>
                                  </label>
                                </div>
                                <div class="mdc-layout-grid__cell--span-6-desktop  mdc-layout-grid__cell--span-12-tablet mdc-layout-grid__cell--span-12-phone">
                                  <div class="mdc-typography--body1">
                                      DNI:
                                  </div>
                                  <label class="mdc-text-field mdc-text-field--filled" id="txt_name" data-assigned-var>
                                      <span class="mdc-text-field__ripple"></span>
    
                                      <input id="txt_company_rtn" value="{{ company.dni }}" class="mdc-text-field__input" type="text" aria-labelledby="my-label-id" readonly >
                                      <span lass="mdc-line-ripple"></span>
                                  </label>
                                </div>
                                <!--
                                <div class="mdc-layout-grid__cell--span-4-desktop  mdc-layout-grid__cell--span-12-tablet mdc-layout-grid__cell--span-12-phone">
                                  <div class="mdc-typography--body1">
                                      EMAIL:
                                  </div>
                                  <label class="mdc-text-field mdc-text-field--filled" id="txt_name" data-assigned-var>
                                      <span class="mdc-text-field__ripple"></span>
    
                                      <input value="" class="mdc-text-field__input" type="text" aria-labelledby="my-label-id" >
                                      <span lass="mdc-line-ripple"></span>
                                  </label>
                                </div>
                                <div class="mdc-layout-grid__cell--span-4-desktop  mdc-layout-grid__cell--span-12-tablet mdc-layout-grid__cell--span-12-phone">
                                  <div class="mdc-typography--body1">
                                      TELEFONO:
                                  </div>
                                  <label class="mdc-text-field mdc-text-field--filled" id="txt_name" data-assigned-var>
                                      <span class="mdc-text-field__ripple"></span>
    
                                      <input value="" class="mdc-text-field__input" type="text" aria-labelledby="my-label-id" >
                                      <span lass="mdc-line-ripple"></span>
                                  </label>
                                </div>
    
                                <div class="mdc-layout-grid__cell--span-8-desktop  mdc-layout-grid__cell--span-12-tablet mdc-layout-grid__cell--span-12-phone">
                                  <div class="mdc-typography--body1">
                                      DIRECCION:
                                  </div>
                                  <label class="mdc-text-field mdc-text-field--filled" id="txt_name" data-assigned-var>
                                      <span class="mdc-text-field__ripple"></span>
                                      
                                      <input value="" class="mdc-text-field__input" type="text" aria-labelledby="my-label-id" >
                                      <span lass="mdc-line-ripple"></span>
                                  </label>
                                </div>-->
                                
                              </div>
                              <div class="mdc-layout-grid__inner">
                                <div class="mdc-layout-grid__cell--span-12-desktop  mdc-layout-grid__cell--span-12-tablet mdc-layout-grid__cell--span-12-phone" style="text-align: center">
                                        <br>
                                     
                                        <a href="" class="mdc-button mdc-button--raised mdc-button--color-secondary  mdc-button--leading no-print" >
                                                
                                            <span class="mdc-button__ripple"></span>
                                            <i class="material-icons mdc-button__icon" aria-hidden="true">download</i>
                                            <span class="mdc-button__label">Ir al Dashboard de {{ company.name }}</span>
                                        </a>
                                        <br>
                                        {% if diagnosis %}
                                
                                            <p>
                                                Diagnostico ya fue enviado
                                            </p>
                        
                                        {% else %}
                                    
                                        <button  onclick="saveDiagnostico()" class="mdc-button mdc-button--raised mdc-button--leading no-print" >
                                                
                                            <span class="mdc-button__ripple"></span>
                                            <i class="material-icons mdc-button__icon" aria-hidden="true">download</i>
                                            <span class="mdc-button__label">Enviar diagnostico</span>
                                        </button>
                                    
                                        {% endif %}
 
                                  </div>
                              </div>
                        </div>
          
                            

                    
                    
                </div>
                </div>
            </div>
                <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-6">
                    <div class="container-dashboard--card-info">
                        <div class="mdc-card mdc-card--color-on-primary">
                            <div class="mdc-card__content">
                                <div class="mdc-typography--headline5 s-font-color-secondary">Resultados</div>
                                <br>
                                <table class="mdc-data-table__table_normal" aria-label="Dessert calories">
                                    <thead>
                                      <tr class="mdc-data-table__header-row">
                                        <th class="mdc-data-table__header-cell" role="columnheader" scope="col">#</th>
                                        <th class="mdc-data-table__header-cell" role="columnheader" scope="col">AREA </th>
                                        <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col">PUNTAJE TOTAL DEL AREA</th>
                                        

                                        <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col">IDEALES</th>
                                        <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col">Resultados</th>
                                      </tr>
                                      
                                      
                                      




                                    </thead>
                                    <tbody class="mdc-data-table__content">
                                    {% for resultado in diagnostico %}                              
                                      <tr class="mdc-data-table__row">
                                        <th class="mdc-data-table__cell" scope="row">
                                            {{loop.index}}
                                        </th>
                                        <th class="mdc-data-table__cell" scope="row">
                                            {{ resultado.area }}
                                        </th>
                                        <td class="mdc-data-table__cell mdc-data-table__header-cell--numeric" scope="row">
                                            {{ resultado.putaje_area }}
                                        </td>
                                        <td class="mdc-data-table__cell mdc-data-table__header-cell--numeric" scope="row">
                                            {{ resultado.ideales }}
                                        </td>
                                        <td class="mdc-data-table__cell mdc-data-table__header-cell--numeric" scope="row">
                                            {{ resultado.resultados }}  
                                        </td>     
                                      </tr>
                                    {% endfor %}
                                    </tbody>
                                  </table>
                            </div>
                            <div class="mdc-card__actions">
                                <div class="mdc-card__actions-buttons"></div>
                                <div class="mdc-card__action-icons">
                                    <button class="mdc-icon-button material-icons mdc-card__action mdc-card__action--icon">
                                        <div class="mdc-icon-button__ripple"></div>
                                        more_vert
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-6">
                    <div class="container-dashboard--card-info">
                        <div class="mdc-card mdc-card--color-on-primary">
                            <div class="mdc-card__content">
                                <div class="mdc-typography--headline5 s-font-color-secondary">RESULTADOS POR CATEGORIA</div>
                                <br>
                                <div id="curve_chart" style="width: 100%; height: 500px"></div>

                            </div>
                            <div class="mdc-card__actions">
                                <div class="mdc-card__actions-buttons"></div>
                                <div class="mdc-card__action-icons">
                                    <button class="mdc-icon-button material-icons mdc-card__action mdc-card__action--icon">
                                        <div class="mdc-icon-button__ripple"></div>
                                        more_vert
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-6">
                    <div class="container-dashboard--card-info">
                        <div class="mdc-card mdc-card--color-on-primary">
                            <div class="mdc-card__content">
                                <div class="mdc-typography--headline5 s-font-color-secondary">RESULTADOS POR CATEGORIA</div>
                                <br>
                    
                                <div id="donutchart" style="width: 100%; height: 500px;"></div>

                            </div>
                            <div class="mdc-card__actions">
                                <div class="mdc-card__actions-buttons"></div>
                                <div class="mdc-card__action-icons">
                                    <button class="mdc-icon-button material-icons mdc-card__action mdc-card__action--icon">
                                        <div class="mdc-icon-button__ripple"></div>
                                        more_vert
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mdc-layout-grid__cell mdc-layout-grid__cell--span-6">
                    <div class="container-dashboard--card-info">
                        <div class="mdc-card mdc-card--color-on-primary">
                            <div class="mdc-card__content">
                                <div class="mdc-typography--headline5 s-font-color-secondary">RESULTADO DEL DIAGNOSTICO</div>
                                <br>
                    
                                <table class="mdc-data-table__table_normal" aria-label="Dessert calories">
                                    <thead>
                                      <tr class="mdc-data-table__header-row">
                                        <th class="mdc-data-table__header-cell" role="columnheader" scope="col">#</th>
                                        <th class="mdc-data-table__header-cell" role="columnheader" scope="col">TIPO EMPRESA </th>
                                        <th class="mdc-data-table__header-cell mdc-data-table__header-cell--numeric" role="columnheader" scope="col">RESULTADO</th>
                                      </tr>
                                      
                                      
                                      
                                    </thead>
                                    <tbody class="mdc-data-table__content">
                                                                             
                                      <tr class="mdc-data-table__row">
                                        {% for resultado in diagnostico %}    
                                        {% if resultado.id_area == 0  %}
         
                                        <th class="mdc-data-table__cell" scope="row">
                                           1
                                        </th>
                                        <th class="mdc-data-table__cell" scope="row">
                                            {{resultado.descripcion }}
                                        </th>
                                        <th class="mdc-data-table__cell mdc-data-table__header-cell--numeric" scope="row">
                                           
                                            {{resultado.resultados}} 
                                        </th>
                                        {% endif %}
                                        {% endfor %}
                                      </tr>


                                    </tbody>
                                  </table>

                            </div>
                            <div class="mdc-card__actions">
                                <div class="mdc-card__actions-buttons"></div>
                                <div class="mdc-card__action-icons">
                                    <button class="mdc-icon-button material-icons mdc-card__action mdc-card__action--icon">
                                        <div class="mdc-icon-button__ripple"></div>
                                        more_vert
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
 
</main>
{% endblock %}
{% block body_script_section %}
<script src="{{ url_for('static', filename='js/bundle/home-dashboard.min.js') }}"></script>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
  google.charts.load('current', {'packages':['corechart']});
  google.charts.setOnLoadCallback(drawChart);

  function drawChart() {
    var data = google.visualization.arrayToDataTable([
      ['AREA', 'IDEALES', 'RESULTADOS'],
      
    {% for resultado in diagnostico %}    
        {% if resultado.id_area != 0  %}
        ['{{resultado.area}}',  {{resultado.ideales}}, {{resultado.resultados}}],
        {% endif %}
    {% endfor %}
    ]);
  
    var options = {
      title: 'RESULTADOS POR CATEGORIA',
      curveType: 'function',
      legend: { position: 'bottom' }
    };

    var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));

    chart.draw(data, options);
  }
</script>

<script type="text/javascript">
      google.charts.load("current", {packages:["corechart"]});
      google.charts.setOnLoadCallback(drawChart);
      function drawChart() {
        var data = google.visualization.arrayToDataTable([
            ['AREA', 'RESULTADOS'],
            {% for resultado in diagnostico %}    
                 {% if resultado.id_area != 0  %}
            ['{{resultado.area}}',     {{resultado.resultados}}],
            {% endif %}
    {% endfor %}
        ]);

        var options = {
          title: 'RESULTADOS POR CATEGORIA',
          pieHole: 0.4,
        };

        var chart = new google.visualization.PieChart(document.getElementById('donutchart'));
        chart.draw(data, options);
      }

      function saveDiagnostico(){

        const Swal = swcms.returnSwal()
        const txt_code = '{{user_uid}}';



        let postData = {
            "txt_code": txt_code,
        };
        console.log(postData)
        let apiUrl = '/api/save/diagnosis/company/';
        //document.getElementById('submitSaveButton').disabled = true;

        swcms.postFetch(apiUrl, postData).then((data) => {
            if(data.status=='200'){
                Swal.fire(
                'Éxito',
                'Diagnostico creado!',
                'success'
                )

                window.setTimeout(() => { window.location.reload(); }, 1500);
            }else{
                let msj = "Por favor busque la inscripción de la empresa con número de DNI: " + data.dni
                Swal.fire(
                'DNI no encontrada',
                msj,
                'Error'
                )
            }
        
        }).catch((error) => {
            Swal.fire(
            'Error de conexión',
            'Por favor revisar tu conexión a internet, si el problema persiste contacta al administrador del sistema',
            'error'
            )
            //document.getElementById('submitSaveButton').disabled = false;
        });
        
      }
  </script>


    

{% endblock %}